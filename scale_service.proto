syntax = "proto2";

package raccoonai;

import "google/protobuf/timestamp.proto";
import "organization.proto";
import "route.proto";
import "truck.proto";
import "user.proto";

option go_package = "./pb";

enum WasteType {
  WASTE_TYPE_UNDEFINED = 0;
  WASTE_TYPE_CONSTRUCTION = 1; // СО
  WASTE_TYPE_MSW = 2; // Municipal Solid Waste - ТБО
  WASTE_TYPE_LIQUID = 3;
  WASTE_TYPE_ORGANIC = 4;
  WASTE_TYPE_LOW_DENSITY_POLYETHYLENE = 5; // ПНД - полиэтилена низкого давления
  WASTE_TYPE_BULKY = 6; // КГМ - крупногабаритный мусор
  WASTE_TYPE_BALLAST = 7; // Балласт
  WASTE_TYPE_OVERSIZED = 8; // Негабарит
  WASTE_TYPE_MIXED = 9; // Отходы микс
  WASTE_TYPE_CELLOPHANE = 10; // Целлофан
  WASTE_TYPE_GLASS_CULLET = 11; // Стеклобой
  WASTE_TYPE_MEDICAL_AND_BIO = 12; // Мед и био отходы
  WASTE_TYPE_ALUMINUM_CANS = 13; // Алюминиевые банки
  WASTE_TYPE_FLAKES = 14; // Флейки
  WASTE_TYPE_PET = 15; // Polyethylene Terephthalate - ПЭТ
  WASTE_TYPE_PETRO_PRODUCTS = 16; // Fuel and lubricants - ГСМ
  WASTE_TYPE_PRESSED_MSW = 17; // Хвосты
  WASTE_TYPE_SORTED_MSW = 18; // Хвосты росыпь - Not Pressed, but sorted
  WASTE_TYPE_NOT_SORTED_MSW = 19; // Хвосты росыпь 1 - Not Pressed and not sorted, due to overload
}

message ScaleBruttoRequest {
  required uint64 owner_organization_id = 1;
  required uint64 truck_id = 2;
  required uint64 driver_id = 3;
  required double weight_kg = 4;
  required WasteType waste_type = 5;
  optional double volume = 6;
  optional bool use_truck_tare_weight = 7;
}

message ScaleNettoRequest {
  required uint64 scale_record_id = 1;
  required double weight_kg = 2;
}

message ScaleResponse {
  required ScaleRecord scale_record = 1;
}

message ScaleRecord {
  required uint64 id = 1;
  required Organization owner_organization = 2;
  required Organization service_provider = 3;
  required double brutto_weight_kg = 4;
  required google.protobuf.Timestamp brutto_scale_ts = 5;
  optional double netto_weight_kg = 6;
  optional google.protobuf.Timestamp netto_scale_ts = 7;
  optional double volume = 8;
  optional bool is_guest_record = 9;
  required WasteType waste_type = 10;
  required Truck truck = 11;
  required User driver = 12;
  optional Route route = 13;
  optional string integration_comments = 14;
  optional RawScaleRecord origin = 15;
}

message ScaleRecordListRequest {
  optional uint64 service_provider_id = 1;
  optional WasteType waste_type = 2;
  optional uint64 driver_id = 3;
  optional uint64 truck_id = 4;
  optional google.protobuf.Timestamp brutto_scale_ts_from = 5;
  optional google.protobuf.Timestamp brutto_scale_ts_to = 6;
}

message ScaleRecordListResponse {
  repeated ScaleRecord scale_records = 1;
}

message RawScaleRecord {
  required uint64 id = 1;
  required uint64 legacy_id = 2;
  optional string truck_number = 3;
  optional string driver_full_name = 4;
  optional google.protobuf.Timestamp first_time_scaled_at = 5;
  optional google.protobuf.Timestamp second_time_scaled_at = 6;
  optional double brutto_kg = 7;
  optional double netto_kg = 8;
  optional double tare_kg = 9;
  optional double volume = 10;
  optional string waste_type = 11;
  optional string sender = 12;
  optional string receiver = 13;
  optional string bin = 14;
  optional string photo_path = 15;
}

service ScaleService {
  rpc ScaleBrutto(ScaleBruttoRequest) returns (ScaleResponse) {}
  rpc ScaleNetto(ScaleNettoRequest) returns (ScaleResponse) {}
  rpc ScaleRecordList(ScaleRecordListRequest) returns (ScaleRecordListResponse) {}
}
