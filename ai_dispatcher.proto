syntax = "proto2";
package raccoonai;

import "general.proto";
import "job.proto";
import "route.proto";


option go_package = "./pb";

//message OnDriverIdlePayload {
//  required uint64 service_provider_id = 1;
//  required uint64 driver_on_shift_id = 2;
//}

message AIDispatcherRequest {
  required uint64 service_provider_id = 1;
}

message AssignmentResponse {
  optional RouteCreate route = 1;
  repeated JobUpdate jobs = 2;
}

message BulkAssignmentResponse {
  repeated AssignmentResponse responses = 1;
}


enum CapacityPlanResponseStatus {
  CAPACITY_PLAN_RESPONSE_STATUS_UNDEFINED = 0;
  CAPACITY_PLAN_RESPONSE_STATUS_OK = 1;
  CAPACITY_PLAN_RESPONSE_STATUS_INVALID_INPUT = 2;
  CAPACITY_PLAN_RESPONSE_STATUS_INTERNAL_ERROR = 3;
}

message CapacityPlanResponse {
  required CapacityPlanResponseStatus status = 1;
  required uint64 num_existing_jobs = 2;
  required uint64 num_expected_jobs = 3;
  required uint64 num_drivers_minimum = 4;

  optional string error_message = 5;
  optional string info_json = 8;
}

service AIDispatcherV4 {
  rpc OnDispatcherHeartbeat(AIDispatcherRequest) returns (BulkAssignmentResponse);
  rpc OnCapacityPlan(AIDispatcherRequest) returns (CapacityPlanResponse);
}
