syntax = "proto2";
package raccoonai;

import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";

option go_package = "./pb";

enum RouteStatus {
  ROUTE_STATUS_UNDEFINED = 0;
  ROUTE_STATUS_CREATED = 1;
  ROUTE_STATUS_IN_PROGRESS = 2;
  ROUTE_STATUS_RETURNING = 3;
  ROUTE_STATUS_COMPLETED = 4;
  ROUTE_STATUS_CANCELLED = 5;
}

enum RouteCategory {
  ROUTE_CATEGORY_UNDEFINED = 0;
  ROUTE_CATEGORY_CO = 1;
  ROUTE_CATEGORY_MSW = 2;
  ROUTE_CATEGORY_LIQUID = 3;
  ROUTE_CATEGORY_TIPPER = 4;
  ROUTE_CATEGORY_DISINFECTION = 5;
}

enum RouteEvent {
  ROUTE_EVENT_UNDEFINED = 0;
  ROUTE_EVENT_CREATE_ROUTE = 1;
  ROUTE_EVENT_START = 2;
  ROUTE_EVENT_RETURN_BACK = 3;
  ROUTE_EVENT_COMPLETE = 4;
  ROUTE_EVENT_CANCEL_ROUTE_DUE_RECEIVER_REASONS = 5;
  ROUTE_EVENT_CANCEL_ROUTE_DUE_PROVIDER_REASONS = 6;
  ROUTE_EVENT_FORCE_COMPLETE = 7;
  ROUTE_EVENT_CREATE_ROUTE_BY_AI = 8;
}

message RouteEventIn {
  required RouteEvent event = 1 [json_name = "event"];
  required uint64 route_id = 2 [json_name = "route_id"];
  optional google.protobuf.Struct payload = 3 [json_name = "payload"];
}

// GET => /v1/platform/route/{id}
message Route {
  required uint64 id = 1 [json_name = "id"];
  required google.protobuf.Timestamp created_at = 2 [json_name = "created_at"];
  required uint64 owner_organization_id = 3 [json_name = "owner_organization_id"];
  required uint64 driver_on_shift_id = 4 [json_name = "driver_on_shift_id"];
  optional double source_lon = 5 [json_name = "source_lon"];
  optional double source_lat = 6 [json_name = "source_lat"];
  optional double destination_lon = 7 [json_name = "destination_lon"];
  optional double destination_lat = 8 [json_name = "destination_lat"];
  optional uint64 author_id = 9 [json_name = "author_id"];
  optional google.protobuf.Timestamp plan_start_at = 10 [json_name = "plan_start_at"];
  optional google.protobuf.Timestamp plan_end_at = 11 [json_name = "plan_end_at"];
  optional google.protobuf.Timestamp fact_start_at = 12 [json_name = "fact_start_at"];
  optional google.protobuf.Timestamp fact_end_at = 13 [json_name = "fact_end_at"];
  required RouteStatus status = 14 [json_name = "status"];
  required bool created_by_ai = 15 [json_name = "created_by_ai"];
  optional bool is_pseudo = 16 [json_name = "is_pseudo"];
  optional double netto = 17 [json_name = "netto"];
  optional uint64 source_location_id = 18 [json_name = "source_location_id"];
  optional uint64 destination_location_id = 19 [json_name = "destination_location_id"];
  optional uint64 current_step_idx = 20 [json_name = "current_step_idx"];
  optional google.protobuf.Timestamp gps_start_at = 21 [json_name = "gps_start_at"];
  optional google.protobuf.Timestamp gps_end_at = 22 [json_name = "gps_end_at"];
  optional uint64 scale_record_id = 23 [json_name = "scale_record_id"];
  optional RouteCategory route_category = 24 [json_name = "route_category"];
}

message RouteCreate {
  optional uint64 owner_organization_id = 1 [json_name = "owner_organization_id"];
  required uint64 driver_on_shift_id = 2 [json_name = "driver_on_shift_id"];
  required double source_lon = 3 [json_name = "source_lon"];
  required double source_lat = 4 [json_name = "source_lat"];
  required double destination_lon = 5 [json_name = "destination_lon"];
  required double destination_lat = 6 [json_name = "destination_lat"];
  optional uint64 author_id = 7 [json_name = "author_id"];
  optional google.protobuf.Timestamp plan_start_at = 8 [json_name = "plan_start_at"];
  optional google.protobuf.Timestamp plan_end_at = 9 [json_name = "plan_end_at"];
  optional bool created_by_ai = 10 [json_name = "created_by_ai"];
  optional bool is_pseudo = 11 [json_name = "is_pseudo"];
  optional double netto = 12 [json_name = "netto"];
  optional uint64 source_location_id = 13 [json_name = "source_location_id"];
  required uint64 destination_location_id = 14 [json_name = "destination_location_id"];
  optional RouteCategory route_category = 15 [json_name = "route_category"];
}

message RouteUpdate {
  required uint64 id = 1 [json_name = "id"];
  optional uint64 driver_on_shift_id = 2 [json_name = "driver_on_shift_id"];
  optional double source_lon = 3 [json_name = "source_lon"];
  optional double source_lat = 4 [json_name = "source_lat"];
  optional double destination_lon = 5 [json_name = "destination_lon"];
  optional double destination_lat = 6 [json_name = "destination_lat"];
  optional google.protobuf.Timestamp plan_start_at = 7 [json_name = "plan_start_at"];
  optional google.protobuf.Timestamp plan_end_at = 8 [json_name = "plan_end_at"];
  optional google.protobuf.Timestamp fact_start_at = 9 [json_name = "fact_start_at"];
  optional google.protobuf.Timestamp fact_end_at = 10 [json_name = "fact_end_at"];
  optional RouteStatus status = 11 [json_name = "status"];
  optional bool is_pseudo = 12 [json_name = "is_pseudo"];
  optional double netto = 13 [json_name = "netto"];
  optional uint64 source_location_id = 14 [json_name = "source_location_id"];
  optional uint64 destination_location_id = 15 [json_name = "destination_location_id"];
  optional uint64 current_step_idx = 16 [json_name = "current_step_idx"];
  optional google.protobuf.Timestamp gps_start_at = 17 [json_name = "gps_start_at"];
  optional google.protobuf.Timestamp gps_end_at = 18 [json_name = "gps_end_at"];
  optional RouteCategory route_category = 19 [json_name = "route_category"];
}

message RouteCreateWithJobs {
  required RouteCreate create = 1 [json_name = "create"];
  repeated uint64 job_ids = 10 [json_name = "job_ids"];
}

message RouteStatusUpdate {
  required uint64 id = 1 [json_name = "id"];
  required RouteStatus status = 2 [json_name = "status"];
}

message RouteDepotIn {
  required uint64 id = 1 [json_name = "id"];
  required double waste_weight = 2 [json_name = "waste_weight"];
}

message RouteDepotOut {
  required uint64 id = 1 [json_name = "id"];
  required double waste_weight = 2 [json_name = "waste_weight"];
}

message RouteCancel {
  required uint64 id = 1 [json_name = "id"];
}

message RouteList {
  repeated Route routes = 1 [json_name = "routes"];
}

message RouteRequest {
  required uint64 route_id = 1 [json_name = "route_id"];
}
