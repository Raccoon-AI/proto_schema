syntax = "proto2";
package raccoonai;

import "google/protobuf/timestamp.proto";
import "organization.proto";
import "user.proto";

option go_package = "./pb";

message AuthResponse {
  required string access_token = 1 [json_name = "access_token"];
  required string token_type = 2 [json_name = "token_type"];
  required User me = 3 [json_name = "me"]; // User information
}

// Not used in messaging. To be deprecated.
message OTPCreate {
  required uint64 user_id = 1 [json_name = "user_id"];
  required uint64 otp_code = 2 [json_name = "otp_code"];
}

message OTPRequest {
  optional string phone_number = 1 [json_name = "phone_number"];
  optional string email = 2 [json_name = "email"];
  required string lang = 3 [json_name = "lang"];
  // "whatsapp" or "email"
  required string preferred_method = 4 [json_name = "preferred_method"];
}

message LoginOTPRequest {
  required string phone_number = 1 [json_name = "phone_number"];
  required uint64 otp = 2 [json_name = "otp"];
}

message LoginToken {
  required string access_token = 1 [json_name = "access_token"];
  required string token_type = 2 [json_name = "token_type"];
}

message PasswordReset {
  required uint64 user_id = 1 [json_name = "user_id"];
  required string old_password = 2 [json_name = "old_password"];
  required string new_password = 3 [json_name = "new_password"];
}

message LoginRequest {
  required string username = 1 [json_name = "username"];
  required string password = 2 [json_name = "password"];
}

message MeResponse {
  required User user = 1 [json_name = "user"];
  optional Organization organization = 2 [json_name = "organization"];
}

message TokenRequest {
  optional uint64 user_id = 1 [json_name = "user_id"];
  optional google.protobuf.Timestamp expiration_date = 2 [json_name = "expiration_date"];
}
