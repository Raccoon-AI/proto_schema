syntax = "proto2";
package raccoonai;

import "driver_on_shift.proto";
import "google/protobuf/timestamp.proto";

option go_package = "./pb";

enum GeoEventType {
  GEO_EVENT_TYPE_UNDEFINED = 0;
  GEO_EVENT_TYPE_SERVICE_STARTED = 1;
  GEO_EVENT_TYPE_SERVICE_COMPLETED = 2;
  GEO_EVENT_TYPE_TRUCK_OFFLINE = 3;
  GEO_EVENT_TYPE_TRUCK_ONLINE = 4;
  GEO_EVENT_TYPE_DUMP_STARTED = 5;
  GEO_EVENT_TYPE_DUMP_COMPLETED = 6;
}

message GeoEventPublishPayload {
  required uint64 truck_id = 1 [json_name = "truck_id"];
  required uint64 location_id = 2 [json_name = "location_id"];
  required google.protobuf.Timestamp datetime = 3 [json_name = "datetime"];
  required uint64 service_provider_id = 4 [json_name = "service_provider_id"];
  required GeoEventType event_type = 5 [json_name = "event_type"];
  optional double duration_minutes = 6 [json_name = "duration_minutes"];
}

enum GeoProcessType {
  GEO_PROCESS_TYPE_UNDEFINED = 0;
  GEO_PROCESS_TYPE_PICKUP_PROCESS = 1;
  GEO_PROCESS_TYPE_DEPOT_PROCESS = 2;
  GEO_PROCESS_TYPE_DEPOT_OFFLINE = 3;
  GEO_PROCESS_TYPE_TRANSIT_PROCESS = 4;
  GEO_PROCESS_TYPE_DUMP_PROCESS = 5;
}

message GeoProcess {
  required uint64 truck_id = 1 [json_name = "truck_id"];
  required uint64 location_id = 2 [json_name = "location_id"];
  required string location_name = 3 [json_name = "location_name"];
  required string location_type = 4 [json_name = "location_type"];
  required uint64 service_provider_id = 5 [json_name = "service_provider_id"];
  required GeoProcessType process_type = 6 [json_name = "process_type"];
  required google.protobuf.Timestamp process_start_at = 7 [json_name = "process_start_at"];
  optional google.protobuf.Timestamp process_end_at = 8 [json_name = "process_end_at"];
  optional google.protobuf.Timestamp last_active_at = 9 [json_name = "last_active_at"];

  optional bool is_active = 10 [json_name = "is_active"];

  optional int32 process_id = 11 [json_name = "process_id"];
  optional float proximity_score = 12 [json_name = "proximity_score"];
  optional int32 start_buffer_id = 13 [json_name = "start_buffer_id"];
  optional int32 end_buffer_id = 14 [json_name = "end_buffer_id"];
  optional float duration_minutes = 15 [json_name = "duration_minutes"];
}

message GeoProcessEnriched {
  required GeoProcess geo_process = 1;
  repeated DriverOnShift driver_on_shifts = 2;
}
